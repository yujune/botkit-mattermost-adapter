
INSERT INTO botkit.external(remark, ip, env_id) VALUES('pgsoft','{1.1.1.1,2.2.2.2}','1') ON CONFLICT (remark) DO NOTHING;

CREATE UNIQUE INDEX external_remark_uniq ON botkit.external(remark)

create function sort_array(character varying[]) returns character varying[] as $$
    select array_agg(n) from (select n from unnest($1) as t(n) order by n) as a;
$$ language sql immutable;

CREATE UNIQUE INDEX ip_uniq ON botkit.external (sort_array(ip));

CREATE INDEX ip_index ON botkit.external USING GIN(ip);

UPDATE botkit.external SET ip = array_cat(ip,'{23.23.23.23,11.11.11.11}') WHERE id = 11
